# CMAR：基于多个类关联规则的准确高效的分类

## 摘要

先前的研究提出，关联分类在处理非结构化数据方面具有很高的分类精度和较强的灵活性。
但是，由于分类仅基于单个高置信度规则，因此仍会遭受大量规则的限制，有时还会出现分类偏差或拟合过度的问题。
在这项研究中，我们提出了一种新的关联分类方法CMAR，即基于多重关联规则的分类。
该方法扩展了一种有效的频繁模式挖掘方法FP-growth，构造了一个与类分布相关的FP-tree，并有效地挖掘了大型数据库。
此外，它采用CR树结构来有效地存储和检索挖掘的关联规则，并基于置信度，相关性和数据库覆盖范围有效地修剪规则。
基于使用多个强关联规则的加权$\chi^2$分析执行分类。
我们对UCI机器学习数据库存储库中的26个数据库进行的广泛实验表明，与CBA和C4.5相比，CMAR是一致的，对各种数据库的分类非常有效，并且具有更好的平均分类准确性。
此外，我们的性能研究表明，与其他已报道的关联分类方法相比，该方法是高效且可扩展的

---

## 介绍

为大型数据库建立准确有效的分类器是数据挖掘和机器学习研究的基本任务之一。
给定一组带有类别标签作为训练集的案例，分类就是建立一个模型（称为分类器）来预测类别标签未知的未来数据对象。

先前的研究已经开发了用于构建分类器的启发式/贪婪搜索技术，例如决策树[10]，规则学习[2]，朴素贝叶斯分类[4]和统计方法[8]。
这些技术从训练数据集中得出具有代表性的规则子集（例如决策树或一组规则）以进行质量预测

最近的研究提出从训练数据集中提取一组高质量的关联规则，这些规则满足某些用户指定的频率和置信度阈值。
通过仔细选择规则，例如CBA [9]，CAEP [3]和ADT [11]，已经建立了有效且高效的分类器。
这种方法从为分类而挖掘的所有规则中采用最有效的规则。
由于关联规则探索了多个变量之间的高度可信关联，因此它可以克服由一次检查一个变量的决策树归纳方法引入的一些约束。
广泛的性能研究[6、9、3、11]表明，基于关联的分类通常可能具有更好的准确性。
但是，此方法也可能会遇到一些缺点，如下所示。

一方面，要确定对新案件进行分类的最有效规则并不容易。
某些方法，例如[9，3，11]，仅选择具有最大用户定义量度（例如置信度）的规则。
正如我们将在后面看到的那样，在许多情况下，这样的选择可能并不总是正确的选择。
这样简单的选择可能会影响分类准确性。

另一方面，训练数据集通常会生成大量规则。
有效地存储，检索，修剪和排序大量规则以进行分类具有挑战性。
许多研究[1，5]指出了组合爆炸性频繁模式的内在本质，因此，当支持阈值小时（即，当考虑到罕见情况时），可能会生成关联规则。
为了实现高精度，分类器可能必须处理大量规则，包括存储由关联挖掘方法生成的规则，检索相关规则以及修剪和排序大量规则。

我们可以解决以上两个问题吗？
为了解决第一个问题，也就是准确地预测一个新案例，而不是仅应用一个规则，可以考虑最相关，高度自信的规则的一小部分，并做出集体而全面的决策。
直观地讲，这将有助于我们避免偏倚，异常以及过小的数据集的过度拟合。
为了克服第二个问题，即基于关联的分类的效率和可伸缩性问题，需要开发一种用于存储和检索规则的有效方法。
由于可以存储和考虑更多规则，因此这可能有助于提高效率以及分类的准确性。 这是本研究的动机。

在本文中，我们开发了一种新技术CMAR，用于准确高效的分类，并做出了以下贡献。

首先，CMAR不是依靠单个规则进行分类，而是通过一组规则来确定类标签。
给定一个新的预测案例，CMAR选择一小套高置信度，高度相关的规则并分析这些规则之间的相关性。
为了避免偏差，我们开发了一种称为加权$\chi^2$的新技术，该技术可以很好地衡量规则在条件支持和类分配下的强度。
广泛的性能研究表明，CMAR通常比CBA [9]和C4.5 [10]具有更高的预测准确性。

其次，为了提高准确性和效率，CMAR采用了一种新颖的数据结构CR树来紧凑地存储和有效地检索大量分类规则。
CR树是一种前缀树结构，用于探索规则之间的共享，从而实现了紧凑性。
CR树本身也是规则的索引结构，可以有效地检索规则

第三，为了加快对完整规则集的挖掘，CMAR采用了最近开发的FP-growth方法的变体。
FP-growth比以前基于关联的分类中使用的类似Apriori的方法（例如[9、3、11]）快得多，尤其是在存在大量规则，大型训练数据集和长模式规则的情况下

本文的其余部分安排如下。
第2节回顾了关联分类的一般概念。
第3节致力于分类规则的生成。
第4节讨论如何使用生成的规则对新数据对象进行分类。
第5节报告了分类精度的实验结果以及效率和可伸缩性的性能研究。
本文的结论在第6节中。

---

## 关联分类

假设一个数据对象$obj = (a_1, ... , a_n)$ 符合形式$(A_1, A_2, ... , A_n)$，我们称$A_1, A_2, ... , A_n$为属性。
属性可以是离散的或连续的。
对于离散属性，我们假定所有可能的值都映射到一组连续的正整数。
对于连续属性，我们假设其值范围离散为间隔，并且间隔也映射到连续的正整数。
这样，在本研究中所有属性均得到统一处理。

令$C=\{c_1, ... , c_n\}$是一个有限的标签集合。
训练数据集的包含一些数据对象，对于每个对象$obj$存在一个标签$c_{obj}\in C$与他关联。
分类器 $\zeta$ 是一个从$(A_1, A_2, ... , A_n)$到$C$的映射。
给定一个对象$obj$，$\zeta(obj)\in C$会返回一个类别标签

通常，给定训练数据集，分类的任务是从训练数据集构建分类器，以便可以将其用于高精度预测未知对象的分类标签。

除了许多不同的分类方法外，例如决策树方法，朴素贝叶斯方法，K-最近邻方法，神经网络方法，一种新方法是探索对象条件和类标签之间的关联关系[9]。
这个想法很自然，因为它在训练数据集中利用案例和类别标签之间的频繁模式和关联关系进行分类。
如果在训练数据集中可以观察到某些频繁模式与类别标签之间的强关联，则可以对相似模式的未来对象进行分类。

一般来说，一个模式$P=a_{i_1},a_{i_2}, ... , a_{i_k}$是一个属性值的集合，对于$(1\leq j\leq k), a_{i_j} \in A_{i_j}$，并且对于任意$j \neq j'$ 有$i_j \neq i_{j'}$
我们说一个数据对象$obj$匹配模式$P=a_{i_1},a_{i_2}, ... , a_{i_k}$，当且仅当对于$(1 \leq j \leq k)$, $obj$的属性$A_{i_j}$值为$a_{i_j}$。（即P中各项不重的属性，与obj中对应属性的值相同）

给定训练集$T$，$c$是一个类别标签。
对于规则$R: P \rightarrow c$，$R$的支持度定义为：$T$中与模式$P$匹配并且标签是$c$的对象的数目，表示为$sup(R)$。
"与模式$P$匹配并且标签是$c$的数量"与"与模式$P$匹配的数量"之比叫做$R$的置信度，写作$conf(R)$

例如，如果失业客户中的95%都不能获得超过3000的信用额度，即规则$R: 失业 \rightarrow 信用额度小于3000$的置信度为95%，之后，我们就可以使用规则$R$来分类将来的数据对象。
为了避免噪声，只有一个规则具有足够的支持度，才能用来分类。
给定一个支持度阈值和置信度阈值，通过这2个阈值，关联分类方法就会找出一个完整的 "类 - 关联 规则" 集合。
当接收了一个新的(未知)的对象，分类器会从这些和数据对象匹配的规则中，选择一个置信度最高的，并且使用它来预测新对象的类别标签。

最近的研究表明，关联分类是直观有效的，并且在许多情况下具有良好的分类准确性。
在大多数现有的关联分类方法中[9、3、11]，使用具有最高置信度的规则进行分类。
但是，这样的决定可能并不总是正确的。

例如， 假定我们知道当前的客户的一些属性值（无工作，投资移民，海外资产>=500k），接下来决定客户的信用额度。匹配这个用户的置信度最高的top 3个规则如下：

- 规则1 $R_1:无工作\rightarrow 额度3000^-$(支持度：3000，置信度：95%);
- 规则2 $R_2:投资移民\rightarrow 额度3000^+$(支持度：5000，置信度：93%);
- 规则3 $R_3:海外资产>=500k\rightarrow 额度3000^+$(支持度：8000，置信度：91%).

那么这样一个客户应该预测什么标签呢？

一个常规的关联分类方法，比如CBA，可能会仅根据规则$R_1$预测$额度3000^-$。
然而，仔细看看规则$R_2$和$R_3$可能会提示我们重新认真的考虑这个决定。
这个3个规则的置信度相似，但是$R_2$和$R_3$有很强的支持度。
基于$R_2$和$R_3$的决定似乎更加可靠。

上面的示例表明，要做出可靠而准确的预测，置信度最高的规则可能并不总是最佳选择，并且基于多个规则的全面，详细和全面的度量分析可能会导致更好的预测质量。

---

## 针对分类任务生成规则

在本节中，我们将实现一种称为CMAR的新关联分类方法，该方法将基于多个关联规则执行分类。
CMAR包含两个阶段：规则生成和分类。

第一阶段，规则生成，CMAR计算了完整的规则集合，规则的形式为$R: P \rightarrow c$，$P$是训练集中的模式，$c$是类别的标签，针对$sup(R)$和$conf(R)$分别给出了阈值。
此外，CMAR会精简一些规则，并且只会选择一个由高质量规则构成的子集，来用于分类。

第二阶段，分类，对于一个给定的数据对象$obj$，CMAR提取了一个与$obj$匹配的规则子集，并且通过分析这个子集的规则来预测类别标签。

这个部分，我们实现了一个算法，针对分类任务来生成规则。
第二个阶段，分类，将会在第4节讨论。

### 3.1 通过支持度和置信度阈值挖掘类别关联规则

为了找到分类的规则，CMAR首先挖掘训练数据，通过支持度和置信度阈值，来找到一个完整的规则集合。
这是典型的频繁模式或关联规则挖掘任务[1]。
为了使挖掘具有高度的可扩展性和效率，CMAR采用了FP-growth方法的一种变体[5]。
FP-growth是一种频繁的模式挖掘算法，比常规的Apriori式方法要快，尤其是在存在大型数据集，低支持阈值和/或长模式的情况下。
以下示例显示了CMAR中挖掘规则的一般概念。

    《数据挖掘》第6章至6.2.4 学习挖掘频繁模式、关联和相关性：FP-tree、FP-growth
    

