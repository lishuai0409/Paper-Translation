# CMAR:基于多类关联规则的准确高效分类

Wenmin Li   Jiawei Han   Jian Pei

## 摘要

以往的研究表明，关联分类在处理非结构化数据时具有较高的分类精度和较强的灵活性。
然而，由于分类仅基于单个高置信度规则，因此它仍然受到大量挖掘规则的困扰，并且有时会出现有偏的分类或过拟合。

在本研究中，我们提出了一种新的关联分类方法CMAR，即基于多重关联规则的分类。
该方法扩展了一种高效的频繁模式挖掘方法——FP-growth，构造了一个类分布关联的FP-tree，有效地挖掘了大型数据库。
此外，该算法采用CR-tree结构高效地存储和检索挖掘出的关联规则，并基于置信度、相关性和数据库覆盖率有效地剪枝规则。分类是基于使用多个强关联规则的加权$\chi^2$分析来执行的。
我们在UCI机器学习数据库中的26个数据库上进行的大量实验表明，与CBA和C4.5相比，CMAR在对各种类型的数据库进行分类时是一致的、高效的，并且具有更好的平均分类精度。
此外，我们的性能研究表明，与其他已报道的关联分类方法相比，该方法是高效的和可扩展的。

## 引言

为大型数据库建立准确高效的分类器是数据挖掘和机器学习研究的基本任务之一。
给定一组以类标签为训练集的案例，分类就是建立一个模型(称为分类器)来预测类标签未知的未来数据对象。
先前的研究已经开发了用于构建分类器的启发式/贪心搜索技术，例如决策树[10]、规则学习[2]、朴素贝叶斯分类[4]和统计方法[8]。
这些技术从用于质量预测的训练数据集归纳出规则的代表性子集(例如，决策树或一组规则)。

最近的研究建议从训练数据集中提取一组高质量的关联规则，这些规则满足特定的用户指定的频率和置信度阈值。
通过仔细选择规则，例如CBA[9]，CAEP[3]和ADT[11]，已经建立了有效且高效的分类器。
这种方法从为分类而挖掘的所有规则中选取最有效的规则。
因为关联规则探索多个变量之间的高度自信的关联，所以它可以克服由一次检查一个变量的决策树归纳方法引入的一些约束。
广泛的性能研究[6，9，3，11]表明，基于关联的分类通常具有更好的准确性。
然而，如下所示，这种方法也有一些缺点。

一方面，要确定最有效的新案例分类规则并不容易。
有些方法，如[9，3，11]，只是选择一个具有最大用户定义度量的规则，如置信度。
正如我们将在后面看到的，在许多情况下，这样的选择并不总是正确的选择。
如此简单的挑选可能会影响分类的准确性。

另一方面，一个训练数据集通常会产生一套庞大的规则。
高效地存储、检索、删减和分类大量规则是一个挑战。
许多研究[1，5]表明了频繁模式的组合爆炸数的固有性质，因此当支持阈值很小时(即，当罕见情况也包括在考虑范围内时)，可以生成关联规则。
为了获得高精度，分类器可能需要处理大量规则，包括存储关联挖掘方法生成的规则，检索相关规则，以及对大量规则进行筛选和排序。

能否解决以上两个问题？
为了解决第一个问题，即准确地预测一个新的案例，而不是只应用一个规则，人们可以考虑最相关的、高度自信的规则的一个小子集，并做出集体的、全面的决定。
直觉上，这将有助于我们避免偏差、异常和过拟合过小的数据集。
为了克服第二个问题，即基于关联的分类的效率和可扩展性问题，人们需要开发有效的方法来存储和检索规则。
这可能有助于提高效率以及分类的准确性，因为可以存储和考虑更多的规则。
这就是本研究的动机。

在本文中，我们开发了一种新的技术，CMAR，用于准确和有效的分类，并做出以下贡献。

首先，CMAR不是依赖单一的分类规则，而是通过一组规则来确定类别标签。
给定一个新的预测案例，CMAR选择一小组高置信度、高度相关的规则，并分析这些规则之间的相关性。
为了避免偏差，我们开发了一种称为加权$\chi^2$的新技术，它可以很好地衡量规则在条件支持和类别分布下的强度。
广泛的性能研究表明，CMAR总体上比CBA[9]和C4.5[10]具有更高的预测精度。

第二，为了提高准确性和效率，CMAR采用了一种新的数据结构，CR-tree，来紧凑地存储和高效地检索大量的分类规则。
CR-tree是一种前缀树结构，用于探索规则之间的共享，实现了实质上的紧凑性。
CR-tree本身也是规则的索引结构，可以有效地服务于规则检索。

第三，为了加快整套规则的挖掘，CMAR采用了最近开发的FP-growth方法的变体。
FP-growth比以前基于关联的分类中使用的类似Apriori的方法(如[9，3，11])快得多，尤其是当存在大量规则、大量训练数据集和长模式规则时。

论文的其余部分安排如下。第二节重温了联想分类的一般思想。第3节致力于分类规则的生成。第4节讨论了如何使用生成的规则对新的数据对象进行分类。第5节报告了分类精度的实验结果以及效率和可扩展性的性能研究。论文在第6节结束。

## 2关联分类

假设数据对象$obj=(a_1,...,a_n)$遵循模式$(A_1,...,A_n)$，其中$A_1,...,A_n$称为属性。
属性可以是分类的或连续的。
对于分类属性，我们假设所有可能的值都映射到一组连续的正整数。
对于一个连续型属性，我们假映射设它的取值范围离散化为区间，区间也为连续的正整数。
通过这样做，所有属性在本研究中都得到了统一处理。

设$ C= \{ c_1,...,c_m \} $是一组有限的类标签。
训练数据集是一组数据对象，使得对于每个对象$obj$，存在一个类标签$ c_{obj} \in C$与之关联。
分类器$\zeta$是一个从$(A_1,...,A_n)$到$C$的函数。
给定一个数据$obj$，$\zeta (obj) \in C$返回一个类标签。

一般来说，给定一个训练数据集，分类的任务是从训练数据集构建一个分类器，使得它可以用于以高精度预测未知对象的类别标签。

除了许多不同的分类方法，如决策树方法、朴素贝叶斯方法、k近邻方法、神经网络方法，一种新的方法是探索对象条件和类标签之间的关联关系[9]。
这个想法很自然，因为它利用训练数据集中案例和类标签之间的频繁模式和关联关系来进行分类。
如果在训练数据集中可以观察到一些频繁模式和类标签之间的强关联，则可以对相似模式的未来对象进行分类。

总的来说，一个模式 $P=a_{i_1}...a_{i_k} $是一组属性值，例如对于$(1 \leq j \leq k)$，$a_{i_j} \in A_{i_j}$并且$i_j \neq i_{j'}$，对于$j' \neq j$。
当且仅当对于$(1 \leq j \leq k)$，$obj$的值$a_{i_j}$属于$A_{i_j}$时，数据对象$obj$与模式$P=a_{i_1}...a_{i_k} $匹配。

给定一个训练数据集$T$，设$c$是一个类标签。
对于规则$ R:P \rightarrow c $，在数据集T中，符合模式P并且属于类别$c$的数据对象的数量称为R的支持度，表示为$sup(R)$.符合模式P并且类别标签是c的数据对象数量在总的符合模式P的数据对象中所占的比例称为R的置信度，表示为$conf(R)$。

例如，如果95%的顾客会因为没有工作而被限制不能得到超过3000美元的信用额度，即，规则R：$没有工作 \rightarrow 限制信用额度少于3000$的置信度为95%，
然后我们可以用规则R来对未来的数据对象进行分类。
为了避免噪声，只有当规则满足足够的支持度才能将它用于分类。
给定一个支持度阈值和一个置信度阈值，关联分类方法找到通过阈值的完整的类关联规则集。
当一个新的(未知的)对象到来时，分类器选择与数据对象相匹配并且具有最高置信度的规则，并使用它来预测新对象的类标签。

最近的研究表明，关联分类直观有效，在许多情况下具有良好的分类精度。
在大多数现有的关联分类方法[9，3，11]中，具有最高置信度的规则用于分类。
然而，这样的决定并不总是正确的。

例如，假设我们想用属性值来确定客户的信用额度$(没有工作，投资移民，海外资产 \geq 500k)$。
与客户匹配的置信度最高的3个规则如下。

$ \bullet 规则 R_1: 没有工作 \rightarrow 信用额度在3000以下 (支持度：3000，置信度：95% ) ;  $
$ \bullet 规则 R_2: 投资移民 \rightarrow 信用额度在3000以上 (支持度：5000，置信度：93% ) ; $
$ \bullet 规则 R_3: 海外资产 \geq 500k \rightarrow 信用额度在3000以上 (支持度：8000，置信度：91% )  $。





















































